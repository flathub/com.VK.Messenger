{
	"id": "com.VK.Messenger",
	"base": "org.electronjs.Electron2.BaseApp",
	"base-version": "24.08",
	"runtime": "org.freedesktop.Platform",
	"runtime-version": "24.08",
	"sdk": "org.freedesktop.Sdk",
	"command": "run",
	"finish-args": [
		"--socket=x11",
		"--device=dri",
		"--share=ipc",
		"--share=network",
		"--socket=pulseaudio",
		"--filesystem=xdg-download"
	],
	"modules": [
		{
			"name": "vk-messenger",
			"buildsystem": "simple",
			"build-commands": [
				"cp -r vk-messenger /app/bin",
				"install -Dm755 run /app/bin/run",

				"install -Dm644 share/icons/hicolor/256x256/apps/vk-messenger.png /app/share/icons/hicolor/256x256/apps/$FLATPAK_ID.png",
				"install -Dm644 share/icons/hicolor/scalable/apps/vk-messenger.svg /app/share/icons/hicolor/scalable/apps/$FLATPAK_ID.svg",
				"install -Dm644 share/applications/vk-messenger.desktop /app/share/applications/$FLATPAK_ID.desktop",
				"install -Dm644 $FLATPAK_ID.metainfo.xml -t /app/share/metainfo",

				"desktop-file-edit --set-icon=com.VK.Messenger --set-key=Exec --set-value=run /app/share/applications/$FLATPAK_ID.desktop"
			],
			"sources": [
				{
					"type": "archive",
					"url": "https://upload.object2.vk-apps.com/vk-me-desktop-dev-5837a06d-5f28-484a-ac22-045903cb1b1a/latest/vk-messenger.rpm",
					"sha256": "c0317881acfe58b9ffc32acb7ffc78675facad22e0f4bbc26ac3d4357c60e4fa"
				},
				{
					"type": "file",
					"path": "com.VK.Messenger.metainfo.xml"
				},
				{
					"type": "script",
					"dest-filename": "run",
					"commands": [
						"zypak-wrapper /app/bin/vk-messenger/vk-messenger"
					]
				}
			]
		}
	]
}