{
    "id": "com.VK.Messenger",
    "base": "org.electronjs.Electron2.BaseApp",
    "base-version": "24.08",
    "runtime": "org.freedesktop.Platform",
    "runtime-version": "24.08",
    "sdk": "org.freedesktop.Sdk",
    "command": "run",
    "finish-args": [
        "--socket=x11",
        "--device=dri",
        "--share=ipc",
        "--share=network",
        "--socket=pulseaudio",
        "--filesystem=xdg-download"
    ],
    "modules": [
        {
            "name": "vk-messenger",
            "buildsystem": "simple",
            "build-commands": [
                "install -Dm644 hicolor/256x256/apps/vk-messenger.png /app/share/icons/hicolor/256x256/apps/$FLATPAK_ID.png",
                "install -Dm644 hicolor/scalable/apps/vk-messenger.svg /app/share/icons/hicolor/scalable/apps/$FLATPAK_ID.svg",
                "install -Dm644 $FLATPAK_ID.desktop /app/share/applications/$FLATPAK_ID.desktop",
                "install -Dm644 $FLATPAK_ID.metainfo.xml -t /app/share/metainfo",
                "ln -s ${FLATPAK_DEST}/extra/vk-messenger ${FLATPAK_DEST}/bin/vk-messenger",
                "install -Dm755 apply_extra ${FLATPAK_DEST}/bin/apply_extra",
                "install -Dm755 run /app/bin/run"
            ],
            "sources": [
                {
                    "type": "extra-data",
                    "url": "https://upload.object2.vk-apps.com/vk-me-desktop-dev-5837a06d-5f28-484a-ac22-045903cb1b1a/latest/vk-messenger-6.0.53-build.334-x86_64.AppImage",
                    "only-arches": [
                        "x86_64"
                    ],
                    "sha256": "9695ec643e63e6eb19708671f09d0f1adaf71117ae04774b7f2aa281d63c1efd",
                    "size": 116427364,
                    "x-checker-data": {
                        "type": "electron-updater",
                        "url": "https://upload.object2.vk-apps.com/vk-me-desktop-dev-5837a06d-5f28-484a-ac22-045903cb1b1a/latest/latest-linux.yml"
                    },
                    "filename": "vk-messenger.deb"
                },
                {
                    "type": "script",
                    "dest-filename": "apply_extra",
                    "commands": [
                        "set -e",
                        "LANG=C bsdtar --to-stdout -xf vk-messenger.deb data.* | LANG=C bsdtar -xf - --strip-components=3",
                        "rm vk-messenger.deb"
                    ]
                },
                {
                    "type": "dir",
                    "path": "icons"
                },
                {
                    "type": "file",
                    "path": "com.VK.Messenger.desktop"
                },
                {
                    "type": "file",
                    "path": "com.VK.Messenger.metainfo.xml"
                },
                {
                    "type": "script",
                    "dest-filename": "run",
                    "commands": [
                        "zypak-wrapper /app/bin/vk-messenger"
                    ]
                }
            ]
        }
    ]
}